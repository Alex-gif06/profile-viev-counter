<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile View Counter</title>
</head>
<body>
    <h1>Profile View Counter</h1>
    <div id="counter"></div> <!-- Это место, где будет отображаться счетчик -->

    <script>
        const GIST_ID = "0bd6b8364a62335974d0d95991edb8c2"; // Замените на свой Gist ID
        const GITHUB_TOKEN = "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"; // Замените на свой GitHub Token (НЕ публикуйте публично)

        async function updateCounter() {
            const gistUrl = `https://api.github.com/gists/${GIST_ID}`;
            const headers = {
                "Authorization": `Bearer ${GITHUB_TOKEN}`,
                "Accept": "application/vnd.github.v3+json",
                "Content-Type": "application/json"
            };
            
            let response = await fetch(gistUrl, { headers });
            let gistData = await response.json();
            let counterData = JSON.parse(gistData.files["counter.json"].content);
            
            // Увеличиваем количество просмотров
            counterData.views += 1;
            
            // Обновляем данные в Gist
            await fetch(gistUrl, {
                method: "PATCH",
                headers,
                body: JSON.stringify({
                    files: {
                        "counter.json": { content: JSON.stringify(counterData, null, 2) }
                    }
                })
            });

            // Генерация изображения с новым значением
            generateCounterImage(counterData.views);
        }

        function generateCounterImage(count) {
            // Пример с динамическим обновлением картинки
            const imageUrl = `https://alex-gif06.github.io/profile-viev-counter/counter.svg?${new Date().getTime()}`; // Для обновления картинки
            document.getElementById("counter").innerHTML = `<img src="${imageUrl}" alt="Profile Views">`; // Обновление на странице
        }

        updateCounter();  // Вызов функции для обновления счетчика
    </script>
</body>
</html>
